<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cultural Committee Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 40px;
            max-width: 900px;
            width: 100%;
            margin: 20px auto;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 28px;
        }

        h2 {
            color: #555;
            margin-bottom: 20px;
            text-align: center;
            font-size: 22px;
        }

        /* Login Form */
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }

        input[type="text"],
        input[type="password"] {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .error {
            color: #e74c3c;
            font-size: 14px;
            text-align: center;
            padding: 10px;
            background: #fee;
            border-radius: 5px;
        }

        /* Dashboard */
        .description {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            color: #333;
            line-height: 1.8;
            font-size: 16px;
        }

        .description textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
        }

        .year-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .year-btn {
            position: relative;
            padding: 20px;
            font-size: 18px;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .year-btn:hover {
            transform: scale(1.05);
        }

        .delete-year {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            padding: 0;
            background: #e74c3c;
            border-radius: 50%;
            font-size: 16px;
            line-height: 1;
        }

        /* Options Page */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .option-btn {
            padding: 40px;
            font-size: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Table */
        .table-container {
            overflow-x: auto;
            margin-top: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .total-row {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 700;
            font-size: 18px;
        }

        .total-row td {
            border: none;
            padding: 15px;
        }

        input[type="text"].table-input,
        input[type="number"].table-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input[type="text"].table-input:focus,
        input[type="number"].table-input:focus {
            border-color: #667eea;
            outline: none;
        }

        .sr-no {
            width: 80px;
            text-align: center;
            font-weight: 600;
        }

        .action-cell {
            width: 100px;
            text-align: center;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .back-btn {
            background: #6c757d;
        }

        .logout-btn {
            background: #e74c3c;
        }

        .add-btn {
            background: #28a745;
        }

        .delete-btn {
            padding: 6px 12px;
            background: #e74c3c;
            font-size: 14px;
        }

        .save-btn {
            background: #28a745;
        }

        .cancel-btn {
            background: #6c757d;
        }

        .edit-btn {
            background: #ffc107;
            color: #333;
        }

        /* User info */
        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .user-badge {
            padding: 5px 15px;
            background: #667eea;
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .admin-badge {
            background: #28a745;
        }

        /* Page management */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Read-only indicator */
        .read-only-notice {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="container page active">
        <h1>üé≠ Cultural Committee Management System</h1>
        <form class="login-form" onsubmit="return handleLogin(event)">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" required autocomplete="username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required autocomplete="current-password">
            </div>
            <button type="submit">Login</button>
            <div id="loginError" class="error" style="display: none;"></div>
        </form>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboardPage" class="container page">
        <div class="user-info">
            <div>
                <h1 style="margin: 0; font-size: 24px;">Cultural Committee Dashboard</h1>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <span class="user-badge" id="userBadge"></span>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>

        <div id="readOnlyNotice" class="read-only-notice" style="display: none;">
            ‚ÑπÔ∏è You are viewing in read-only mode. You cannot make any changes.
        </div>

        <div class="description">
            <div id="descriptionView"></div>
            <div id="descriptionEdit" style="display: none;">
                <textarea id="descriptionTextarea"></textarea>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="save-btn" onclick="saveDescription()">Save Description</button>
                    <button class="cancel-btn" onclick="cancelDescEdit()">Cancel</button>
                </div>
            </div>
        </div>

        <div class="btn-group" id="adminDescControls" style="display: none;">
            <button class="edit-btn" onclick="editDescription()">Edit Description</button>
        </div>

        <h2>Select Academic Year</h2>
        <div class="year-grid" id="yearGrid"></div>

        <div class="btn-group" id="adminYearControls" style="display: none;">
            <button class="add-btn" onclick="addNewYear()">+ Add New Year</button>
        </div>
    </div>

    <!-- Year Options Page -->
    <div id="optionsPage" class="container page">
        <div class="user-info">
            <h1 style="margin: 0; font-size: 24px;" id="optionsYearTitle"></h1>
            <button class="back-btn" onclick="goToDashboard()">‚Üê Back to Dashboard</button>
        </div>

        <h2>Select Transaction Type</h2>
        <div class="options-grid">
            <button class="option-btn" onclick="showTable('collection')">
                üí∞ Collection
            </button>
            <button class="option-btn" onclick="showTable('expenditure')">
                üí∏ Expenditure
            </button>
        </div>
    </div>

    <!-- Table Page -->
    <div id="tablePage" class="container page">
        <div class="user-info">
            <div>
                <h1 style="margin: 0; font-size: 24px;" id="tableTitle"></h1>
                <p style="margin: 5px 0 0 0; color: #666;" id="tableYearSubtitle"></p>
            </div>
            <button class="back-btn" onclick="goToOptions()">‚Üê Back</button>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th class="sr-no">Sr. No</th>
                        <th>Name</th>
                        <th id="amountColumnHeader">Amount (‚Çπ)</th>
                        <th class="action-cell" id="actionHeader" style="display: none;">Action</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="2">TOTAL</td>
                        <td id="totalAmount">‚Çπ 0.00</td>
                        <td id="totalActionCell" style="display: none;"></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div class="btn-group" id="adminTableControls" style="display: none;">
            <button class="add-btn" onclick="addTableRow()">+ Add New Entry</button>
        </div>
    </div>

    <script>
        // Authentication credentials (securely stored in JavaScript)
        const CREDENTIALS = {
            'Admin': { password: 'Password@123', role: 'admin' },
            'MTYC123': { password: 'MTYC@123', role: 'viewer' }
        };

        // Global state
        let currentUser = null;
        let currentRole = null;
        let selectedYear = null;
        let selectedType = null;

        // Default data structure
        let appData = {
            description: "Welcome to the Cultural Committee Management System. This comprehensive platform is designed to streamline the management of all financial activities including collections and expenditures across various academic years. Select an academic year below to view detailed financial records or manage transactions.",
            years: {
                '2024-25': {
                    collection: [
                        { name: 'Student Registration Fees', amount: 25000 },
                        { name: 'Event Sponsorship - Tech Corp', amount: 50000 },
                        { name: 'Annual Day Tickets', amount: 15000 }
                    ],
                    expenditure: [
                        { name: 'Auditorium Booking', amount: 20000 },
                        { name: 'Sound & Lighting Equipment', amount: 15000 },
                        { name: 'Decorations & Props', amount: 8000 }
                    ]
                },
                '2025-26': {
                    collection: [
                        { name: 'Membership Fees', amount: 30000 },
                        { name: 'Workshop Registration', amount: 12000 }
                    ],
                    expenditure: [
                        { name: 'Venue Rental', amount: 18000 },
                        { name: 'Refreshments', amount: 5000 }
                    ]
                }
            }
        };

        // Initialize app
        function initApp() {
            loadDataFromStorage();
            renderDashboard();
        }

        // Local Storage Management
        function saveDataToStorage() {
            localStorage.setItem('culturalCommitteeData', JSON.stringify(appData));
        }

        function loadDataFromStorage() {
            const stored = localStorage.getItem('culturalCommitteeData');
            if (stored) {
                try {
                    appData = JSON.parse(stored);
                } catch (e) {
                    console.error('Error loading data:', e);
                }
            }
        }

        // Authentication
        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');

            if (CREDENTIALS[username] && CREDENTIALS[username].password === password) {
                currentUser = username;
                currentRole = CREDENTIALS[username].role;
                
                errorDiv.style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                showPage('dashboardPage');
                setupUserInterface();
                renderDashboard();
            } else {
                errorDiv.textContent = '‚ùå Invalid username or password. Please try again.';
                errorDiv.style.display = 'block';
            }

            return false;
        }

        function handleLogout() {
            currentUser = null;
            currentRole = null;
            selectedYear = null;
            selectedType = null;
            showPage('loginPage');
        }

        // UI Setup based on role
        function setupUserInterface() {
            const isAdmin = currentRole === 'admin';
            
            // Update user badge
            const badge = document.getElementById('userBadge');
            badge.textContent = currentUser + (isAdmin ? ' (Admin)' : ' (Viewer)');
            badge.className = 'user-badge ' + (isAdmin ? 'admin-badge' : '');

            // Show/hide read-only notice
            document.getElementById('readOnlyNotice').style.display = isAdmin ? 'none' : 'block';

            // Admin controls visibility
            document.getElementById('adminDescControls').style.display = isAdmin ? 'flex' : 'none';
            document.getElementById('adminYearControls').style.display = isAdmin ? 'flex' : 'none';
            document.getElementById('adminTableControls').style.display = isAdmin ? 'flex' : 'none';
            document.getElementById('actionHeader').style.display = isAdmin ? 'table-cell' : 'none';
            document.getElementById('totalActionCell').style.display = isAdmin ? 'table-cell' : 'none';
        }

        // Description Management
        function renderDescription() {
            document.getElementById('descriptionView').innerHTML = `<p>${appData.description}</p>`;
        }

        function editDescription() {
            document.getElementById('descriptionTextarea').value = appData.description;
            document.getElementById('descriptionView').style.display = 'none';
            document.getElementById('descriptionEdit').style.display = 'block';
        }

        function saveDescription() {
            appData.description = document.getElementById('descriptionTextarea').value;
            saveDataToStorage();
            cancelDescEdit();
        }

        function cancelDescEdit() {
            document.getElementById('descriptionView').style.display = 'block';
            document.getElementById('descriptionEdit').style.display = 'none';
            renderDescription();
        }

        // Year Management
        function renderYears() {
            const grid = document.getElementById('yearGrid');
            grid.innerHTML = '';

            Object.keys(appData.years).sort().forEach(year => {
                const btn = document.createElement('button');
                btn.className = 'year-btn';
                btn.textContent = year;
                btn.onclick = () => selectYear(year);

                if (currentRole === 'admin') {
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'delete-year';
                    deleteBtn.innerHTML = '√ó';
                    deleteBtn.onclick = (e) => {
                        e.stopPropagation();
                        deleteYear(year);
                    };
                    btn.appendChild(deleteBtn);
                }

                grid.appendChild(btn);
            });
        }

        function addNewYear() {
            const year = prompt('Enter new academic year (e.g., 2026-27):');
            if (year && year.trim()) {
                const yearKey = year.trim();
                if (appData.years[yearKey]) {
                    alert('This year already exists!');
                    return;
                }
                appData.years[yearKey] = {
                    collection: [],
                    expenditure: []
                };
                saveDataToStorage();
                renderYears();
            }
        }

        function deleteYear(year) {
            if (confirm(`Are you sure you want to delete the year "${year}"? This will remove all associated data.`)) {
                delete appData.years[year];
                saveDataToStorage();
                renderYears();
            }
        }

        function selectYear(year) {
            selectedYear = year;
            document.getElementById('optionsYearTitle').textContent = `Academic Year: ${year}`;
            showPage('optionsPage');
        }

        // Table Management
        function showTable(type) {
            selectedType = type;
            const title = type === 'collection' ? 'üí∞ Collection' : 'üí∏ Expenditure';
            document.getElementById('tableTitle').textContent = title;
            document.getElementById('tableYearSubtitle').textContent = `Academic Year: ${selectedYear}`;
            document.getElementById('amountColumnHeader').textContent = type.charAt(0).toUpperCase() + type.slice(1) + ' (‚Çπ)';
            
            renderTable();
            showPage('tablePage');
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            const records = appData.years[selectedYear][selectedType];
            let total = 0;

            records.forEach((record, index) => {
                const row = tbody.insertRow();
                
                // Sr. No
                const cell1 = row.insertCell(0);
                cell1.className = 'sr-no';
                cell1.textContent = index + 1;

                // Name
                const cell2 = row.insertCell(1);
                if (currentRole === 'admin') {
                    cell2.innerHTML = `<input type="text" class="table-input" value="${record.name}" onchange="updateRecord(${index}, 'name', this.value)">`;
                } else {
                    cell2.textContent = record.name;
                }

                // Amount
                const cell3 = row.insertCell(2);
                if (currentRole === 'admin') {
                    cell3.innerHTML = `<input type="number" class="table-input" value="${record.amount}" min="0" step="0.01" onchange="updateRecord(${index}, 'amount', this.value)">`;
                } else {
                    cell3.textContent = `‚Çπ ${parseFloat(record.amount).toFixed(2)}`;
                }

                // Action (Admin only)
                if (currentRole === 'admin') {
                    const cell4 = row.insertCell(3);
                    cell4.className = 'action-cell';
                    cell4.innerHTML = `<button class="delete-btn" onclick="deleteTableRow(${index})">Delete</button>`;
                }

                total += parseFloat(record.amount) || 0;
            });

            document.getElementById('totalAmount').textContent = `‚Çπ ${total.toFixed(2)}`;
        }

        function addTableRow() {
            appData.years[selectedYear][selectedType].push({
                name: 'New Entry',
                amount: 0
            });
            saveDataToStorage();
            renderTable();
        }

        function deleteTableRow(index) {
            if (confirm('Are you sure you want to delete this entry?')) {
                appData.years[selectedYear][selectedType].splice(index, 1);
                saveDataToStorage();
                renderTable();
            }
        }

        function updateRecord(index, field, value) {
            if (field === 'amount') {
                value = parseFloat(value) || 0;
            }
            appData.years[selectedYear][selectedType][index][field] = value;
            saveDataToStorage();
            renderTable();
        }

        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        function goToDashboard() {
            renderDashboard();
            showPage('dashboardPage');
        }

        function goToOptions() {
            showPage('optionsPage');
        }

        function renderDashboard() {
            renderDescription();
            renderYears();
        }

        // Initialize on page load
        initApp();
    </script>
</body>
</html>